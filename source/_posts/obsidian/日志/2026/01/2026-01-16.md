---
title: '2026-01-16'
author: Spa-Master
date: '2026-01-16 00:00:00'
updated: '2026-01-16 00:00:00'
tags:
- lang/shell
---

## 命令传参

- `$0` - Name of the script
- `$1` to `$9` - Arguments to the script. `$1` is the first argument and so on.
- `$@` - All the arguments
- `$#` - Number of arguments
- `$?` - Return code of the previous command
- `$$` - Process identification number (PID) for the current script
- `!!` - Entire last command, including arguments. A common pattern is to execute a command only for it to fail due to missing permissions; you can quickly re-execute the command with sudo by doing `sudo !!`
- `$_` - Last argument from the last command. If you are in an interactive shell, you can also quickly get this value by typing `Esc` followed by `.` or `Alt+.`

## 命令替换 vs 进程替换

### 1. 核心区别

|**特性**|**命令替换 (Command Substitution)**|**进程替换 (Process Substitution)**|
|---|---|---|
|**语法**|`$(CMD)`|`<(CMD)`|
|**替换内容**|**输出的文本数据** (Stdout)|**临时文件的路径** (如 `/dev/fd/63`)|
|**C++ 类比**|**值传递** (Pass by Value)|**指针/句柄传递** (Pass by Pointer/Reference)|
|**接收端预期**|接收**字符串**参数的命令 (如 `echo`, `for`)|接收**文件名**参数的命令 (如 `diff`, `cat`)|

---

### 2. 深度解析

#### A. 命令替换 `$(CMD)`

- **机制**：Shell 执行 `CMD`，捕获它的标准输出，然后把这些**字符串内容**直接粘贴到当前命令行位置。
    
- **场景**：你需要处理命令的**结果本身**。
    
- **典型用法**：
    
    1. **赋值变量**：
        
        
```bash
current_date=$(date +%F)
# 等同于: string current_date = "2026-01-16";
```
        
    2. **循环遍历**：
        
        
```bash
for file in $(ls *.cpp); do ... done
# 等同于: std::vector<string> files = list_files(); for(auto f : files)...
```
        

#### B. 进程替换 `<(CMD)`

- **机制**：Shell 执行 `CMD`，将输出连接到一个**命名管道 (Named Pipe)** 或 `/dev/fd/` 下的临时文件描述符。然后，它把这个**管道的路径**（例如 `/dev/fd/63`）粘贴到当前命令行位置。
    
- **场景**：
    
    1. 目标命令**不支持从 Stdin 读取数据**，只接受**文件路径**作为参数（如 `diff`）。
        
    2. 你需要同时把**两个或多个**命令的输出传给一个程序。
        
- 典型用法：
不创建临时文件比较两个目录的差异：

```bash
diff <(ls dir1) <(ls dir2)
```

Shell 实际执行的操作：

```bash
diff /dev/fd/63 /dev/fd/64
```

> [!info]- 为什么 `<(CMD)>` 是个神技
> 如果没有进程替换，当你想比较两个命令的输出时，你必须手动管理临时文件（这是 C++ 程序员最讨厌的 `malloc` 后忘记 `free` 的既视感）


## 计划
学习ONNX, TensorRT, TVM等模型部署工具

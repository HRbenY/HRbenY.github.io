---
title: 最佳平方逼近
author: Spa-Master
date: '2026-01-11 23:33:58'
updated: '2026-01-11 23:33:58'
tags: []
---

> 离散情况将积分换成求和。

最佳平方逼近，本质上就是高维空间里的“垂直投影”。最佳平方逼近的过程就是要让误差**垂直于**$\{1, x, x^2\}$张成的空间的每一个基方向。
## 内积

在几何里，判断两个向量是否垂直，我们用点积（Dot Product）是否为 0。
在函数的世界里，内积就是点积的连续版本：

$$\langle f, g \rangle = \int_a^b f(x)g(x) dx$$

如果这个积分为 0，我们就说这两个函数“垂直”（正交）。
## 法方程（正规方程）

我们要找系数 $c_0, c_1, c_2$，让**误差 $R = f - (c_0 \cdot 1 + c_1 \cdot x + c_2 \cdot x^2)$ 垂直于所有的基 $\{1, x, x^2\}$**。

这意味着我们要列出三个垂直方程：

1. 误差 垂直于 $1$：$\langle R, 1 \rangle = 0$
    
2. 误差 垂直于 $x$：$\langle R, x \rangle = 0$
    
3. 误差 垂直于 $x^2$：$\langle R, x^2 \rangle = 0$

我们可以将第二个式子展开看一下：

$$\langle R, x \rangle = \langle f - (c_0 \cdot 1 + c_1 \cdot x + c_2 \cdot x^2), \quad x \rangle = 0$$
用内积的定义展开后可以发现本质上是几项的和做积分，显然满足结合律和分配律。
拆开：
$$\langle f, x \rangle - c_0\langle 1, x \rangle - c_1\langle x, x \rangle - c_2\langle x^2, x \rangle = 0$$
把带 $c$ 的项移到等号左边，把已知的 $f$ 留到右边：
$$c_0\langle 1, x \rangle + c_1\langle x, x \rangle + c_2\langle x^2, x \rangle = \langle f, x \rangle$$
这就构成法方程的一行。将所有方程组合起来，我们得到法方程：

$$\boxed{H\mathbf{c} = \mathbf{b}\rightarrow\begin{pmatrix} \langle 1, 1 \rangle & \langle 1, x \rangle & \langle 1, x^2 \rangle \\ \langle x, 1 \rangle & \langle x, x \rangle & \langle x, x^2 \rangle \\ \langle x^2, 1 \rangle & \langle x^2, x \rangle & \langle x^2, x^2 \rangle \end{pmatrix} \begin{pmatrix} c_0 \\ c_1 \\ c_2 \end{pmatrix} = \begin{pmatrix} \langle f, 1 \rangle \\ \langle f, x \rangle \\ \langle f, x^2 \rangle \end{pmatrix}}$$
 > 离散情况下的H实际上就是$A^TA$ 
 
 **左边矩阵 $H$ 的元素 $\langle x^i, x^j \rangle$：**

- **含义**：这是**坐标轴之间的夹角/相关性**。
    
- **解释**：我们在用 $\{1, x, x^2\}$ 建立坐标系。但是这三个基函数并不是互相垂直的（正交的）。比如 $x$ 和 $x^2$ 在 $[0, \pi]$ 上都主要是正的，它们有“重叠”。
    
- 矩阵里的 $\langle x, x^2 \rangle$ 就是在衡量：基函数 $x$ 和基函数 $x^2$ 有多相似。如果它们完全垂直（正交），这个矩阵就会变成对角矩阵（非对角线全是0），解起来就超级简单。但因为它们不正交，我们需要这个矩阵来修正这种“坐标轴倾斜”带来的扭曲。
    

 **右边向量 $\mathbf{b}$ 的元素 $\langle f, x^i \rangle$：**

- **含义**：这是**目标函数在各个轴上的投影分量**。
    
- **解释**：
    
    - $\langle f, 1 \rangle$：$f$ 包含多少“常数成分”（也就是平均高度）。
        
    - $\langle f, x \rangle$：$f$ 包含多少“线性成分”（趋势）。
        
    - $\langle f, x^2 \rangle$：$f$ 包含多少“弯曲成分”。
        
- 这就像我们在问：目标函数 $f$ 和 $x$ 这个形状有多像？越像，积分值越大，说明在这个方向上的分量应该越多。

> 有时候列式求的时候f中有$x^2$或者$x$，可以把这些先放一边，算出余下部分后将系数相加。

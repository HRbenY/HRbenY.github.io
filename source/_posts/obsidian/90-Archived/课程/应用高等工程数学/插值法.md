---
title: 插值法
author: Spa-Master
date: '2026-01-11 23:33:15'
updated: '2026-01-11 23:33:15'
tags: []
---

## Lagrange

### 基函数

这个基函数 $l_i(x)$ 只有两个核心任务（**也就是它的“0-1性质”）：

1. **在自己的节点（$x_i$）必须是 1**：当 $x$ 等于这个节点 $x_i$ 时，函数值为 1。
    
2. **在其他节点（$x_j, j \neq i$）必须是 0**：当 $x$ 等于其他任何节点时，函数值统统为 0。

公式为
$$l_i(x) = \prod_{j=0, j \neq i}^{n} \frac{x - x_j}{x_i - x_j}$$

> 假设有三个点 $x_0, x_1, x_2$。我们要写出 $l_1(x)$（中间那个点的基函数）：
> 
> $$l_1(x) = \frac{(x - x_0)}{(x_1 - x_0)} \cdot \frac{(x - x_2)}{(x_1 - x_2)}$$
>代入 $x_0$：分子第一项是 0 $\rightarrow$ 结果为 0。
>代入 $x_2$：分子第二项是 0 $\rightarrow$ 结果为 0。
>代入 $x_1$：分子变成 $(x_1-x_0)(x_1-x_2)$，和分母一样 $\rightarrow$ 结果为 1。
### Lagrange插值多项式

把每个点的**高度（$y$值）** 乘上它对应的**基函数** ，然后加起来：
$$L(x) = \sum_{i=0}^n f(x_i)l_i(x) = y_0 \cdot l_0(x) + y_1 \cdot l_1(x) + \dots + y_n \cdot l_n(x)$$
可以从$L(x)$的形式看出$f(x)$究竟是什么

### 误差余项

$$R_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!} \prod_{i=0}^n (x - x_i)$$

$\prod_{i=0}^n (x - x_i)$保证插值节点上误差为0。

> 当将拉格朗日插值的节点逐渐逼近到同一点$x_0$的时候，$\prod_{i=0}^n (x - x_i)$就变成了泰勒公式里面的$(x-x_0)^{n+1}$

**注意**求导系数和阶乘次数都为$n + 1$。

一般会利用余项公式求插值多项式在某区间上的插值误差。此时要求的是误差上界，$\xi$ 取使 $|f^{(n+1)}(\xi)|$最大的值。$\prod_{i=0}^n (x - x_i)$ 太复杂的话不用求，也直接摆出来就好。
### 差商

$$f[x_0, x_1, ..., x_n] = \frac{f^{(n)}(\xi)}{n!}$$

> 符号 **$f[x_0, x_1, x_2, x_3, x_4]$** 读作“$f$ 关于节点 $x_0, \dots, x_4$ 的四阶差商”

**定理：** 若 $f(x)$ 是一个 $n$ 次多项式，即 $f(x) = a_n x^n + a_{n-1} x^{n-1} + \dots + a_0$，那么它的 **$n$ 阶差商** 就是它的 **最高次项系数 $a_n$**。

原理是什么？（直观理解）

导数的规律：

- 对 $x^4$ 求 1 次导 $\rightarrow$ 变 $x^3$
    
- 对 $x^4$ 求 2 次导 $\rightarrow$ 变 $x^2$
    
- ...
    
- 对 $x^4$ 求 4 次导 $\rightarrow$ 变 常数
    

差商其实就是 离散版本的“导数”。

$$f[x_i, x_j] = \frac{f(x_i) - f(x_j)}{x_i - x_j} \approx f'(x)$$

当你对一个 4 次多项式做 4 阶差商时，就像对它求了 4 次导数一样（虽然数值上差一个阶乘倍数），它会把所有低次项（$x^3, x^2 \dots$）都“消灭”掉，只留下最高次项的信息，变成一个**恒定的常数**。

**如果不是多项式...**
 $\xi$ 有范围，如果消不掉会让求误差界限。取 $\xi$为区间内让导数绝对值最大的值。

## Newton

$$N(x) = c_0 + c_1(x-z_0) + c_2(x-z_0)(x-z_1)+ ...+c_n\prod_{i = 0}^{n}(x-z_i)$$

借助[差商表](#差商)计算。取对角线作为多项式系数$c_i$，越靠右系数越高。
比如下面这个例子：

|**i**|**xi​**|**f(xi​) (0阶)**|**1阶差商 f[⋅,⋅]**|**2阶差商 f[⋅,⋅,⋅]**|**3阶差商 f[⋅,⋅,⋅,⋅]**|
|---|---|---|---|---|---|
|**0**|**0**|**3** ($c_0$)||||
||||$\frac{3-3}{1-0} = \mathbf{0}$ ($c_1$)|||
|1|1|3||$\frac{1/2 - 0}{3/2 - 0} = \frac{1/2}{3/2} = \mathbf{\frac{1}{3}}$ ($c_2$)||
||||$\frac{13/4 - 3}{3/2 - 1} = \frac{1/4}{1/2} = \frac{1}{2}$||$\frac{-11/3 - 1/3}{2 - 0} = \frac{-4}{2} = \mathbf{-2}$ ($c_3$)|
|2|3/2|13/4||$\frac{-19/6 - 1/2}{2 - 1} = -\frac{22}{6} = -\frac{11}{3}$||
||||$\frac{5/3 - 13/4}{2 - 3/2} = \frac{20-39}{12} \times 2 = -\frac{19}{6}$|||
|3|2|5/3||||

## 分段线性插值

把曲线分成小段，在每段上做n=1的Lagrange插值。

### 误差余项
> 其实就是Lagrange误差余项取n=1的情况，再取x为区间中点以取得最大误差。

$$|R(x)| \le \frac{M_2}{8} h^2$$
- **$M_2$**：是 $|f''(x)|$ 的最大值。
    
- **$h$**：是步长（相邻节点之间的距离），这里 $h = 0.1$。
    
- **$1/8$ 怎么来的？**：这是 $(x-x_i)(x-x_{i+1})$ 在区间中点取到的最大值的绝对值 $\frac{h^2}{4}$，再除以公式里的 $2!$，所以是 $\frac{1}{8}$。
## Hermite

在Newton插值得基础上将导数也纳入计算差商。一般题目会给定某点的函数值和导数。

比如

| **zi​** | **f(zi​)**    | **一阶差商**                                 | **二阶差商**                                  | **三阶差商**                                 |
| ------- | ------------- | ---------------------------------------- | ----------------------------------------- | ---------------------------------------- |
| **0**   | **0** ($c_0$) |                                          |                                           |                                          |
|         |               | $\frac{1-0}{0.5-0} = \mathbf{2}$ ($c_1$) |                                           |                                          |
| 0.5     | 1             |                                          | $\frac{2-2}{0.5-0} = \mathbf{0}$ ($c_2$)  |                                          |
|         |               | **$f'(0.5) = 2$** (特殊规则!)                |                                           | $\frac{-4-0}{1-0} = \mathbf{-4}$ ($c_3$) |
| 0.5     | 1             |                                          | $\frac{0-2}{1-0.5} = \frac{-2}{0.5} = -4$ |                                          |
|         |               | $\frac{1-1}{1-0.5} = 0$                  |                                           |                                          |
| 1       | 1             |                                          |                                           |                                          |
这里已知$f'(0.5)$，所以多写一行(0.5, 1)，并直接写一阶差商为2。正常读对角线作为牛顿插值的系数。

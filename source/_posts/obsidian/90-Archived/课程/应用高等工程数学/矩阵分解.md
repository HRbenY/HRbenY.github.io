---
title: 矩阵分解
author: Spa-Master
date: '2026-01-11 20:33:36'
updated: '2026-01-11 20:33:36'
tags: []
---

## 满秩分解

将原矩阵做行初等变换，化成行最简型。比如
$$A = \begin{pmatrix} 1 & 2 & 3 & 0 \\ 0 & 2 & 1 & -1 \\ 1 & 0 & 2 & 1 \end{pmatrix} \xrightarrow{\text{行变换}} G = \begin{pmatrix} 1 & 0 & 2 & 1 \\ 0 & 1 & \frac{1}{2} & -\frac{1}{2} \\0 & 0 & 0 & 0 \end{pmatrix}$$
化成行最简后，列之间的关系依旧保留，比如这里第三列可以由前两列表示为:

$$\begin{pmatrix} 2 \\ 0.5 \end{pmatrix} = 2 \times \begin{pmatrix} 1 \\ 0 \end{pmatrix}+ 0.5 \times \begin{pmatrix} 0 \\ 1 \end{pmatrix}$$
那么在原矩阵中也一定有这种关系。那么我们用原矩阵的前两列作为基，右乘G就可以得到原矩阵。即
$$A=FG$$

## QR分解

$$
A = QR
$$
其中Q是正交矩阵，R是上三角矩阵。

### Q

将A按列施密特正交化后单位化得到Q

### R
$$Q = (\varepsilon_1, \varepsilon_2, \varepsilon_3), \quad A = (\alpha_1, \alpha_2, \alpha_3)$$
$$R = \begin{pmatrix} \langle \varepsilon_1, \alpha_1 \rangle & \langle \varepsilon_1, \alpha_2 \rangle & \langle \varepsilon_1, \alpha_3 \rangle \\ 0 & \langle \varepsilon_2, \alpha_2 \rangle & \langle \varepsilon_2, \alpha_3 \rangle \\ 0 & 0 & \langle \varepsilon_3, \alpha_3 \rangle \end{pmatrix}$$


因为Q是单位正交矩阵，满足$QQ^T=I$，所以可以如下计算R：
$$
R=Q^TA
$$

## 奇异值分解

$$A = U \Sigma V^T$$
假设$$A = \begin{pmatrix} 1 & 1 \\ 1 & 1 \\ 1 & -1 \end{pmatrix}$$
### $\Sigma$ 

奇异值，$A^TA$的特征值开方。

> 为什么不直接算A的特征值？
>
>因为A可能不是方阵，不存在特征值。$A^TA$是方阵，一定有特征值。且其特征值是A的奇异值的平方。

计算
$$
A^T A = \begin{pmatrix} 1 & 1 & 1 \\ 1 & 1 & -1 \end{pmatrix} \begin{pmatrix} 1 & 1 \\ 1 & 1 \\ 1 & -1 \end{pmatrix} = \begin{pmatrix} 3 & 1 \\ 1 & 3 \end{pmatrix}
$$
特征值为
- $\lambda_1 = 4$
- $\lambda_2 = 2$
奇异值为
- $\sigma_1 = \sqrt{4} = \mathbf{2}$
- $\sigma_2 = \sqrt{2} = \mathbf{\sqrt{2}}$

## $V$
V的每一列都是$A^TA$单位正交的特征向量。刚好可以跟$\Sigma$一起算。对应特征值的特征向量：

- 对于 $\lambda_1 = 4$：解 $(A^T A - 4I)x = 0$
    
    $\begin{pmatrix} -1 & 1 \\ 1 & -1 \end{pmatrix} \implies x_1 = x_2$。取单位向量：$\mathbf{v}_1 = \begin{pmatrix} \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} \end{pmatrix}$
    
- 对于 $\lambda_2 = 2$：解 $(A^T A - 2I)x = 0$
    
    $\begin{pmatrix} 1 & 1 \\ 1 & 1 \end{pmatrix} \implies x_1 = -x_2$。取单位向量：$\mathbf{v}_2 = \begin{pmatrix} \frac{1}{\sqrt{2}} \\ -\frac{1}{\sqrt{2}} \end{pmatrix}$
    

得到矩阵 $V$：

$$V = (\mathbf{v}_1, \mathbf{v}_2) = \begin{pmatrix} \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} \end{pmatrix}$$
## U

利用刚才求出的矩阵V生成U
$$\mathbf{u}_i = \frac{1}{\sigma_i} A \mathbf{v}_i$$
其中$vi$是V的列向量，$\sigma_i$是对应的奇异值，$u_i$是U的列向量。注意顺序不要对应错了。

此外，**矩阵 $U$ 必须是 $m \times m$ 的方阵**（这题里是 $3 \times 3$），V只有两列，我们目前只得到了两个U的列向量。我们需要找一个向量，使得它 **同时垂直于** 已经算出来的 $u_1$ 和 $u_2$，并且长度为 1。

- 计算 $u_1$：

$$\mathbf{u}_1 = \frac{1}{2} \begin{pmatrix} 1 & 1 \\ 1 & 1 \\ 1 & -1 \end{pmatrix} \begin{pmatrix} \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} \end{pmatrix} = \frac{1}{2} \begin{pmatrix} \sqrt{2} \\ \sqrt{2} \\ 0 \end{pmatrix} = \begin{pmatrix} \frac{\sqrt{2}}{2} \\ \frac{\sqrt{2}}{2} \\ 0 \end{pmatrix}$$

- 计算 $u_2$：

$$\mathbf{u}_2 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1 & 1 \\ 1 & 1 \\ 1 & -1 \end{pmatrix} \begin{pmatrix} \frac{1}{\sqrt{2}} \\ -\frac{1}{\sqrt{2}} \end{pmatrix} = \frac{1}{\sqrt{2}} \begin{pmatrix} 0 \\ 0 \\ \frac{2}{\sqrt{2}} \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \\ 1 \end{pmatrix}$$

- 解方程组 $\begin{cases} u_1^T x = 0 \\ u_2^T x = 0 \end{cases}$，其实就是求零空间。 把 $u_1^T, u_2^T$ 作为行向量写成矩阵，求基础解系。
---
## 题外话

在$U$和$V$都是**单位正交矩阵**的情况下($U^T = U^{-1}$)

$$\begin{align}
A^T A &= (U \Sigma V^T)^T (U \Sigma V^T) \\
      &= (V \Sigma^T U^T) (U \Sigma V^T) \\
      &= V (\Sigma^T \Sigma) V^T \\
	  &= V (\Sigma^2) V^T = V (\Sigma^2) V^{-1}
\end{align}$$
得出来的$A^T A = V \Sigma^2 V^{-1}$就是特征值分解的形式。
- 中间的 **$\Sigma^2$**： $A^T A$ 的 **特征值矩阵**。
- 两边的 **$V$**： $A^T A$ 的 **特征向量矩阵**。

我们知道 SVD 的核心定义是 $A = U \Sigma V^T$，这意味着：

$$A V = U \Sigma$$

把列向量拆开看，就是：

$$A \mathbf{v}_i = \sigma_i \mathbf{u}_i$$

于是得到求解 $u_i$ 的黄金公式：

$$\boxed{\mathbf{u}_i = \frac{1}{\sigma_i} A \mathbf{v}_i}$$

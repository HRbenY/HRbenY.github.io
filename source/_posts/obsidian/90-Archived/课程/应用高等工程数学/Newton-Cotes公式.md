---
title: Newton-Cotes公式
author: Spa-Master
date: '2026-01-12 00:14:38'
updated: '2026-01-12 00:14:38'
tags: []
---

$$\int_a^b f(x) dx \approx (b-a) \sum_{k=0}^n C_k^{(n)} f(x_k)$$
根据Cotes系数的不同有不同的公式。常用的是n=1梯形公式和n=2辛普森公式。
## 梯形公式

$$I \approx \frac{b-a}{2} [f(a) + f(b)]=\frac{h}{2} [f(a) + f(b)]$$
这里因为梯形公式将整个区间视为一步，所以$h=b-a$

### 复化

把曲边梯形切成**首位相接**的 $n$ 个小条，每个小条都用**直边梯形**来近似，然后面积求和。

- **步长**：$h = \frac{b-a}{n}$
    
- **节点**：$x_k = a + k \cdot h \quad (k=0, 1, \dots, n)$
    
- 公式：
    
    $$T_n = \frac{h}{2} \left[ f(x_0) + 2\sum_{k=1}^{n-1} f(x_k) + f(x_n) \right]$$
注意首尾两个点是一倍，中间是两倍

### 误差余项

复化梯形公式的误差截断项（Error Term）为：

$$|E_T| \approx \frac{b-a}{12} h^2 \cdot M_2$$

- **$b-a$**：积分区间长度 $= 2.2 - 1.0 = 1.2$。
    
- **$h$**：步长 $= 1.6 - 1.0 = 0.6$。
    
- **$M_2$**：是 $|f''(x)|$ 在区间 $[1.0, 2.2]$ 上的最大值。

## 辛普森公式
$$I \approx \frac{b-a}{6} [f(a) + 4f(\frac{a+b}{2}) + f(b)]=\frac{h}{3} [f(a) + 4f(\frac{a+b}{2}) + f(b)]$$
辛普森的区间内有两个步长，所以$h=\frac{b-a}{2}$
### 复化

把积分区间切成 $n$ 等分（**注意：$n$ 必须是偶数**），每两个小段凑成一组（3个点），上面覆盖一条**抛物线**来近似。

- **条件**：$n$ 必须为**偶数**（因为辛普森公式每次消耗2个区间段）。
    
- **步长**：$h = \frac{b-a}{n}$
    
- 公式：
    
    $$S_n = \frac{h}{3} \left[ f(x_0) + 4\sum_{k=1,3,5\dots}^{n-1} f(x_k) + 2\sum_{k=2,4,6\dots}^{n-2} f(x_k) + f(x_n) \right]$$
也就是141的系数往后重合，重合一次变成14241，两次变成1424241。

### 误差余项 

Simpson 公式的误差截断项为：

$$|E_S| \approx \frac{b-a}{180} h^4 \cdot M_4$$

- **系数**：注意分母变成了 **180**（比梯形公式小得多）。
    
- **$h^4$**：步长的 4 次方。
    
- **$M_4$**：是 $|f^{(4)}(x)|$ 在区间上的最大值。
